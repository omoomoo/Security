#同源策略

##JSONP
JSONP（JSON with Padding）是浏览器跨域技术的其中一种实现。JSON with Padding顾名思义就是对JSON数据进行填充从而实现跨域的访问。

JSONP由两部分组成：**回调函数**和**JSON数据**。

我们知道JSON数据格式跟JavaScript的对象格式是一致，这也是JSONP技术之所以能工作的原因之一。

假设我们现在位于a.com域名下，我们想访问b.com域名下的资源，其URL为`http://b.com/book/10086`，数据格式如下：

```JSON
{id:10086, name:"JavaScript高级程序设计"}
```

由于同源策略原因，我们是不能直接访问b.com下的资源的。我们可以通过jQuery的ajax方法进行尝试，`$.get('http://b.com/book/10086')`会发觉这个请求压根就不能发送。

我们知道，在默认情况下，网页的\<script src=""\>\</script\>标签是不受同源策略的限制的(HTML5中可以进行限制)，此时，我们可以通过script标签的src属性进行对`http://b.com/book/10086`访问。

```JavaScript
var script = document.createElement('script');
// https://raw.githubusercontent.com/cokepluscarbon/road-to-growth/master/24.book.jsonp 
script.src = 'http://b.com/book/10086';
document.body.appendChild(script);
```

当我们把script节点插入到DOM节点后，浏览器就会对`http://b.com/book/10086`的资源进行访问，然后把请求的资源当做JavaScript脚本执行，由于JSON数据格式跟JavaScript的对象格式一致，所以不会有语法错误，但是我们也无法解析JSON的数据内容。

这时候，我们就急需一种方法解析JSON的数据内容。这时候，我们可以首先声明一个处理资源的方法例如

```JavaScript
function get(data) {
    console.log(data);
}
```

然后，我们可以将资源的JSON格式以参数的形式包含在get方法中，返回的数据格式修改为（需要服务器的配置）：

```JavaScript
get({id:10086, name:"JavaScript高级程序设计"});
```

我们不妨将这个回调函数放在http请求中，方便服务器对JSON数据进行填充，URL修改为：`http://b.com/book/10086?callback=get`

缺点：

 * 不安全，容易被注入恶意脚本
 * 仅限于JSON数据格式
 * 需要服务器对JSON数据进行填充
 * 局限于GET请求
    